(this["webpackJsonppotatos-way-to-kitchen-xstate"]=this["webpackJsonppotatos-way-to-kitchen-xstate"]||[]).push([[0],{29:function(t,e,n){},40:function(t,e,n){"use strict";n.r(e),n.d(e,"promptAndAsk",(function(){return f})),n.d(e,"say",(function(){return j})),n.d(e,"listen",(function(){return x}));var s=n(26),c=n(8),l=(n(29),n(7),n(23)),i=n(12),o=n(2),a=n(20),r=n(44),u=n(43);function p(t){return Object(o.q)((e=>({type:"SPEAK",value:t})))}function g(t){return{entry:t,always:"#root.dm.nextStep"}}const m={initial:"init",states:{init:{on:{CLICK:"welcome"}},welcome:{initial:"prompt",states:{prompt:{entry:[Object(o.q)((t=>({type:"SPEAK",value:"Hey help me to find the kitchen keys"}))),"gameStart",Object(o.q)("MAXSPEECH",{delay:6e4,id:"timeout"})],on:{ENDSPEECH:"#root.dm.nextStep"}}}},intent:{invoke:{id:"nlu",src:(t,e)=>{return n=t.text_intent,fetch(new Request("https://cors-anywhere.herokuapp.com/https://mr-batata.herokuapp.com/model/parse",{method:"POST",headers:{Origin:"http://maraev.me"},body:'{"text": "'.concat(n,'"}')})).then((t=>t.json()));var n},onDone:{target:"classify_intent",actions:[Object(o.b)(((t,e)=>({intent:e.data.intent.name}))),(t,e)=>console.log(e.data),Object(o.b)(((t,e)=>({confidence:e.data.intent.confidence})))]},onError:{target:"nextStep",actions:(t,e)=>console.log(e.data)}}},classify_intent:{entry:Object(o.q)("ENDSPEECH"),on:{ENDSPEECH:[{target:"right",cond:t=>"right"===t.intent},{target:"left",cond:t=>"left"===t.intent},{target:"jump",cond:t=>"jump"===t.intent},{target:"take",cond:t=>"take"===t.intent},{target:"open",cond:t=>"open"===t.intent},{target:"close",cond:t=>"close"===t.intent},{target:"nomatch"}]}},right:Object(c.a)({},g("goRight")),left:Object(c.a)({},g("goLeft")),jump:Object(c.a)({},g("jump")),open:Object(c.a)({},g("open")),close:Object(c.a)({},g("close")),take:Object(c.a)({},g("take")),confirm:{initial:"prompt",states:{prompt:{entry:p("Where? Which direction?"),on:{ENDSPEECH:"#root.dm.nextStep"}}}},nomatch:{initial:"prompt",states:{prompt:{entry:p("What?"),on:{ENDSPEECH:"#root.dm.nextStep"}}}},nextStep:{initial:"ask",on:{RECOGNISED:[{target:"stop",cond:t=>"stop"===t.recResult},{target:"intent",actions:Object(o.b)((t=>({text_intent:t.recResult})))}],MAXSPEECH:[{target:"maxspeech"}]},states:{ask:{entry:Object(o.q)("LISTEN")}}},maxspeech:{entry:"lose",always:"#root.dm.init"},stop:{entry:p("Ok"),always:"init"}}};var d=n(21),b=n(13);const y=i.a.cancel;var h=!0;function f(t){return{initial:"prompt",states:{prompt:{entry:j(t),on:{ENDSPEECH:"ask"}},ask:{entry:Object(o.q)("LISTEN")}}}}function j(t){return Object(o.q)((e=>({type:"SPEAK",value:t})))}function x(){return Object(o.q)("LISTEN")}Object(u.a)({url:"https://statecharts.io/inspect",iframe:!1});const E=Object(a.a)({id:"root",type:"parallel",states:{dm:Object(c.a)({},m),asrtts:{initial:"idle",states:{idle:{on:{LISTEN:"recognising",SPEAK:{target:"speaking",actions:Object(o.b)(((t,e)=>({ttsAgenda:e.value})))}}},recognising:{initial:"progress",entry:"recStart",exit:"recStop",on:{ASRRESULT:{actions:["recLogResult",Object(o.b)(((t,e)=>({recResult:e.value})))],target:".match"},RECOGNISED:{target:"idle"},MAXSPEECH:"idle",ENDMAX:{actions:y("timeout")}},states:{progress:{},match:{entry:Object(o.q)("RECOGNISED")}}},speaking:{entry:"ttsStart",on:{ENDSPEECH:"idle"}}}}}},{actions:{recLogResult:t=>{console.log("<< ASR: "+t.recResult)},test:()=>{console.log("test")},logIntent:t=>{console.log("<< NLU intent: "+t.nluData.intent.name)}}}),O=t=>{switch(!0){case t.state.matches({asrtts:"recognising"}):return Object(b.jsx)("button",Object(c.a)(Object(c.a)({type:"button",className:"glow-on-hover",style:{animation:"glowing 20s linear"}},t),{},{children:"Listening..."}));case t.state.matches({asrtts:"speaking"}):return Object(b.jsx)("button",Object(c.a)(Object(c.a)({type:"button",className:"glow-on-hover",style:{animation:"bordering 1s infinite"}},t),{},{children:"Speaking..."}));default:return Object(b.jsx)("button",Object(c.a)(Object(c.a)({type:"button",className:"glow-on-hover"},t),{},{children:"Start Game"}))}};var S=!0,L=!1;function R(){var t=document.getElementById("batata"),e=document.getElementById("bg");const n=Object(d.useSpeechSynthesis)({onEnd:()=>{m("ENDSPEECH")}}),c=n.speak,l=n.cancel,i=(n.speaking,Object(d.useSpeechRecognition)({onResult:t=>{m({type:"ASRRESULT",value:t})}})),o=i.listen,a=(i.listening,i.stop),u=Object(r.b)(E,{devTools:!0,actions:{recStart:Object(r.a)((()=>{console.log("Ready to receive a command."),o({interimResults:!1,continuous:!0})})),recStop:Object(r.a)((()=>{console.log("Recognition stopped."),a()})),gameStart:Object(r.a)((t=>{var e=document.getElementById("timer");null!=e&&e.remove(),function(){const t=document.createElement("div");t.id="timer",t.innerHTML='\n    <img id = "timer_element" src="https://timertopia.files.wordpress.com/2017/04/1-minute.gif" width="110" ">\n    ';var e=document.getElementById("bg");null!=e&&e.appendChild(t)}()})),goRight:Object(r.a)((n=>{console.log("moving the potato to the right..."),null!=t&&null!=e&&(console.log(e.style.backgroundImage),h&&(t.style.marginLeft="0px",h=!1),n.recResult.includes("cabinet")||n.recResult.includes("cupboard")||n.recResult.includes("closet")?t.style.marginLeft="210px":n.recResult.includes("drawer")?t.style.marginLeft="220px":n.recResult.includes("chair")?t.style.marginLeft="490px":n.recResult.includes("table")||n.recResult.includes("tub")||n.recResult.includes("bathtub")||n.recResult.includes("bus")||n.recResult.includes("stop")?t.style.marginLeft="700px":n.recResult.includes("window")||n.recResult.includes("curtains")?t.style.marginLeft="900px":t.style.marginLeft=(parseInt(t.style.marginLeft.replace("px",""))+70).toString()+"px")})),goLeft:Object(r.a)((e=>{console.log("moving the potato to the left..."),null!=t&&(h&&(t.style.marginLeft="0px",h=!1),e.recResult.includes("cabinet")||e.recResult.includes("cupboard")||e.recResult.includes("closet")?t.style.marginLeft="210px":e.recResult.includes("drawer")?t.style.marginLeft="220px":e.recResult.includes("chair")?t.style.marginLeft="490px":e.recResult.includes("table")||e.recResult.includes("tub")||e.recResult.includes("bathtub")||e.recResult.includes("bus")||e.recResult.includes("stop")?t.style.marginLeft="700px":e.recResult.includes("window")||e.recResult.includes("curtains")?t.style.marginLeft="900px":t.style.marginLeft=(parseInt(t.style.marginLeft.replace("px",""))-70).toString()+"px")})),open:Object(r.a)((n=>{console.log("opening..."),null!=e&&null!=t&&(L?t.style.marginLeft>"210px"&&t.style.marginLeft<"290px"&&(e.style.backgroundImage='url("https://i.imgur.com/3PXWTO9.jpeg")'):S&&t.style.marginLeft>"129px"&&t.style.marginLeft<"230px"&&(e.style.backgroundImage='url("https://i.imgur.com/WQhVQYi.png")'))})),lose:Object(r.a)((e=>{console.log("Game Over"),null!=t&&"https://i.imgur.com/zCqQtnF.png"==t.src&&(t.src="https://i.imgur.com/KmN8LvB.png",t.style.width="200px",t.style.height="160px")})),close:Object(r.a)((n=>{console.log("closing..."),null!=e&&null!=t&&(L?t.style.marginLeft>"210px"&&t.style.marginLeft<"290px"&&(e.style.backgroundImage="url('https://i.imgur.com/fBxj3Sm.jpeg')"):t.style.marginLeft>"139px"&&t.style.marginLeft<"220px"&&S&&(e.style.backgroundImage="url('https://i.imgur.com/RuUfqPe.png')"))})),jump:Object(r.a)((n=>{console.log("jumping..."),console.log(L),null!=t&&null!=e&&L&&t.style.marginLeft>"650px"&&t.style.marginLeft<"750px"&&(e.style.backgroundImage="url('https://i.imgur.com/sFtt7VG.png')",t.style.display="none")})),take:Object(r.a)((n=>{if(console.log("play video..."),null!=t&&null!=e)if(S)t.style.marginLeft>"139px"&&t.style.marginLeft<"220px"&&(m("ENDMAX"),null!=(s=document.getElementById("timer"))&&(s.style.display="none"),t.src="http://pa1.narvii.com/7324/3ec4179c3653b974d7197b01fe372f1ec4e45b4er1-370-300_00.gif",t.style.width="220px",t.style.height="170px",v("Next Level"),S=!1,L=!0);else if(L){var s;if(t.style.marginLeft>"650px"&&t.style.marginLeft<"750px")m("ENDMAX"),null!=(s=document.getElementById("timer"))&&(s.style.display="none"),e.style.backgroundImage="url('https://i.imgur.com/xuOXlv5.jpg')",t.style.display="",t.src="http://pa1.narvii.com/7324/3ec4179c3653b974d7197b01fe372f1ec4e45b4er1-370-300_00.gif",t.style.width="220px",t.style.height="170px",v("Celebrate")}})),ttsStart:Object(r.a)(((t,e)=>{console.log("Speaking..."),c({text:t.ttsAgenda})})),ttsCancel:Object(r.a)(((t,e)=>{console.log("TTS STOP..."),l()}))}}),p=Object(s.a)(u,3),g=p[0],m=p[1];p[2];return Object(b.jsx)("div",{className:"App",id:"bg",children:Object(b.jsx)(O,{state:g,onClick:()=>m("CLICK")})})}function v(t){const e=document.createElement("div");e.className="row",t.includes("Next")?e.innerHTML="<button id='nxt-btn' class='buttonNext' onclick='goToNextLvl()'>Next Level</button>":e.innerHTML="<button id='nxt-btn2' class='buttonNext' onclick='displayVid()'>Celebrate</button>";var n=document.getElementById("bg");null!=n&&n.appendChild(e)}const k=document.getElementById("root");l.render(Object(b.jsx)(R,{}),k)}},[[40,1,2]]]);
//# sourceMappingURL=main.0923fc1d.chunk.js.map